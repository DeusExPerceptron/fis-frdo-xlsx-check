# fis-frdo-xlsx-check

Проверка файлов XLSX перед загрузкой на портал ФИС ФРДО. На основе шаблона актуального на 18 июня 2022 года.

Проверяет все файлы *.xlsx в каталоге в котором находится скрипт.

Проверяет все заполненные строчки. Пустые строки пропускает. Пустой строкой считается строка, в которой все поля пустые (кроме 'Срок обучения, лет')

- Проверка на наличие данных (кроме 'Отчество получателя' и с 'Наименование документа об образовании (оригинала)' по 'Номер документа для изменения')
- Проверка на стартовые и замыкающие пробелы, и символ переноса строки (все поля)
- Проверка на допустимые символы (кириллица, пробел и тире) для полей 'Фамилия получателя', 'Имя получателя', 'Отчество получателя'
- Проверка полей на допустимые значения и пределы (для тех, которые указаны в шаблоне xlsx)
- Проверка СНИЛС на соответствие формату (XXX-XXX-XXX XX) и сверка контрольной суммы

**Внимание. Проверка полей с 'Наименование документа об образовании (оригинала)' по 'Номер документа для изменения' происходит только на стартовые/конечные пробелы и перенос строки**

По итогам проверки для каждой таблицы *.xlsx создается файл с отчетом *.log в котором перечислены все обнаруженные ошибки, а также указано количество проверенных записей.

**v1.2**
- Изменена проверка на пустую строку. Теперь непустой строкой считается строка, в которой заполнено хотя бы одна ячейка (за исключением 'Срок обучения, лет' из-а формулы в таблице)

**v1.1**
- Замена признака пустой строки с поля "Наименование документа" на поле "Фамилия получателя"
- Для проверки теперь загружается первый лист в файле, а не с именем "Шаблон"
